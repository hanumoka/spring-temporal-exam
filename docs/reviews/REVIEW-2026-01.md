# 문서 검토 리포트 (2026-01)

## 검토 일시
2026년 1월 28일 (최종 업데이트)

## 검토 범위
- `docs/study/` 전체 문서 (24개)
- `docs/architecture/` 전체 문서 (3개)
- `CLAUDE.md`

---

## 발견된 주요 이슈

### 1. 치명적 이슈 (Critical)

#### 1.1 temporalio/auto-setup 이미지 Deprecated
| 항목 | 내용 |
|------|------|
| 위치 | `phase3/01-temporal-concepts.md`, `phase3/02-temporal-spring.md` |
| 현재 | `temporalio/auto-setup:1.22.0` / `1.22.3` |
| 문제 | **Deprecated** - `temporalio/docker-builds` 저장소 **2026-01-05 아카이브됨** |
| 해결 | Temporal CLI (`server start-dev`) 또는 `temporalio/server` 이미지 사용 |
| 새 위치 | Docker Compose 예제: [temporalio/samples-server/compose](https://github.com/temporalio/samples-server/tree/main/compose) |
| 참조 | [Temporal Deployment Guide](https://docs.temporal.io/self-hosted-guide/deployment) |

#### 1.2 Promtail EOL (End-of-Life)
| 항목 | 내용 |
|------|------|
| 위치 | `phase2b/07-loki.md` |
| 현재 | `grafana/promtail:2.9.0` |
| LTS 기간 | **2025년 2월 13일 ~ 2026년 2월 28일** (보안/버그 수정만) |
| EOL | **2026년 3월 2일** - 이후 모든 지원 종료 |
| 대체제 | **Grafana Alloy** (OpenTelemetry Collector 기반) |
| 마이그레이션 | `alloy convert --source-format=promtail --output=config.alloy promtail.yml` |
| 참조 | [Promtail Migration Guide](https://grafana.com/docs/loki/latest/setup/migrate/migrate-to-alloy/) |

---

### 2. 버전 불일치 (Version Mismatch)

| 컴포넌트 | 문서 버전 | 최신 버전 | 위치 | 우선순위 |
|----------|-----------|-----------|------|----------|
| Temporal SDK | 1.22.3 | 1.32.1 | phase3/02-temporal-spring.md | High |
| Temporal UI | 2.21.x | 3.x | phase3/*.md | High |
| Loki | 2.9.0 | 3.6.0 | phase2b/07-loki.md | Medium |
| Grafana | 10.2.0 | 12.3.1 | phase2b/06,07,08.md | Medium |
| Prometheus | v2.48.0 | v3.9.1 | phase2b/06,08.md | Medium |
| Alertmanager | v0.26.0 | v0.28.x | phase2b/08.md | Low |
| Redisson | 3.27.0 | 4.0.0 | phase2a/03, phase2b/03.md | High |

---

### 3. 호환성 이슈

#### 3.1 Spring Boot 4 + Temporal SDK
| 항목 | 내용 |
|------|------|
| 문제 | Temporal Spring Boot Starter가 Spring Boot 3.x 기준으로 문서화됨 |
| 현황 | Spring Boot 4.0 호환성 공식 미확인 |
| 상태 | TECH-STACK.md에 이미 경고 포함 (적절함) |

#### 3.2 Spring Boot 4 + Redisson
| 항목 | 내용 |
|------|------|
| 문제 | 문서에서 3.27.0 사용, Spring Boot 4는 4.0.0 필요 |
| 해결 | Redisson 4.0.0으로 업데이트 필요 |

---

### 4. 개선 권장 사항

#### 4.1 Temporal 개발 환경 설정
**현재 방식 (Deprecated)**:
```yaml
services:
  temporal:
    image: temporalio/auto-setup:1.22.3  # DEPRECATED (저장소 아카이브됨)
```

**권장 방식 1: Temporal CLI (가장 간단)**:
```bash
# 개발용: Temporal CLI 사용 (SQLite 내장, 별도 DB 불필요)
temporal server start-dev

# Docker로 CLI 실행
docker run --rm -p 7233:7233 -p 8233:8233 \
  temporalio/temporal:latest \
  server start-dev --ip 0.0.0.0
```

**권장 방식 2: Docker Compose (외부 DB 사용)**:
```bash
# 새로운 공식 예제 저장소 사용
git clone https://github.com/temporalio/samples-server.git
cd samples-server/compose
docker-compose up -d
```

> **참고**: `temporalio/docker-compose` 저장소는 2026-01-05 아카이브됨.
> 새 예제는 [samples-server/compose](https://github.com/temporalio/samples-server/tree/main/compose) 참조

#### 4.2 로그 수집 방식
**현재 방식 (EOL 예정)**:
```yaml
promtail:
  image: grafana/promtail:2.9.0  # EOL: 2026-03-02
```

**권장 방식 (Grafana Alloy)**:
```yaml
alloy:
  image: grafana/alloy:latest
  volumes:
    - ./alloy-config.alloy:/etc/alloy/config.alloy
```

---

## 수정 계획

### Phase 1: 필수 수정 (Critical)
1. [x] TECH-STACK.md - 버전 및 Deprecated 경고 업데이트
2. [x] phase3/*.md - Temporal 설정 업데이트 + 경고 추가
3. [x] phase2b/07-loki.md - Promtail EOL 경고 + Alloy 대안 추가

### Phase 2: 버전 업데이트 (High Priority)
4. [x] Redisson 버전 업데이트 (3.27.0 → 4.0.0)
5. [x] Temporal SDK 버전 업데이트 (1.22.3 → 1.32.1)

### Phase 3: 버전 업데이트 (Medium Priority)
6. [x] Grafana Stack 버전 참고 노트 추가
7. [x] Prometheus 버전 참고 노트 추가

---

## 추가 결정 사항 (2026-01-25)

### D015. 외부 서비스 시뮬레이션 전략
| 항목 | 내용 |
|------|------|
| 결정 | **Fake 구현체 (인터페이스 기반)** |
| 배경 | 실제 PG사/SMS/Email API 연동 불가 (개발 계정/비용 이슈) |
| 목적 | MSA 환경의 어려움(세마포어, 재시도, 분산 트랜잭션) 학습 |
| 적용 | Payment Service, Notification Service |
| 문서 | [D015 상세](./architecture/DECISIONS.md#d015-외부-서비스-시뮬레이션-전략) |

**시뮬레이션 시나리오**:
- 지연 응답 → Resilience4j 타임아웃 학습
- 간헐적 실패 → 재시도 전략 학습
- 연속 실패 → 서킷 브레이커 학습
- 동시 요청 → 세마포어 효과 확인
- 부분 성공 → 보상 트랜잭션 (Saga) 학습

### D016. Core 라이브러리 전략
| 항목 | 내용 |
|------|------|
| 결정 | **자체 개발 + JAR 배포** |
| 우선순위 | **최후 목표** - Phase 3 완료 후 진행 |
| 목적 | 개인 프로젝트용 공통 라이브러리 개발 및 재사용 |
| 참조 | sonix_kingarthur core (패턴/구조 참고) |
| 모듈 | core-lock, core-stream, core-observability |
| 문서 | [D016 상세](./architecture/DECISIONS.md#d016-core-라이브러리-전략) |

### Spring Boot 버전 변경
| 항목 | 변경 전 | 변경 후 |
|------|---------|---------|
| Spring Boot | 4.0.1 | **3.4.0** |
| Redisson | 4.0.0 | **3.52.0** |
| starter-web | webmvc | **web** |

**변경 이유**:
- Core 라이브러리와 동일 버전 유지
- Temporal SDK 호환성 보장 (Spring Boot 3.x 공식 지원)
- 추후 고도화 시 Spring Boot 4.x 전환 예정

---

## 문서 리팩토링 (2026-01-25)

### 수정된 링크 오류

| 파일 | 수정 내용 |
|------|----------|
| `study/00-overview.md` | Phase 2-A 파일명 링크 수정 (02→02, 03→03 등) |
| `study/phase2a/01-saga-pattern.md` | 다음 단계: 02-resilience4j → 02-idempotency |
| `study/phase2a/02-idempotency.md` | 다음 단계: 06-bean-validation → 03-resilience4j |
| `study/phase2a/03-resilience4j.md` | 다음 단계: 03-distributed-lock → 04-distributed-lock |
| `study/phase2a/04-distributed-lock.md` | 다음 단계: 04-optimistic-lock → 05-optimistic-lock |
| `study/phase2a/05-optimistic-lock.md` | 다음 단계: 05-idempotency → 06-bean-validation |

### PROGRESS.md 개선

- 학습 순서 다이어그램 추가
- 순서 번호(#) 컬럼 추가로 명확화
- Phase별 학습 문서 링크 추가
- 실습 가이드 컬럼 추가 (Phase 1)

### 일관성 개선

- 학습 순서: PROGRESS.md ↔ study 문서의 "다음 단계" 링크 일치
- 용어 사용: "멱등성이 재시도의 전제조건" 설명 추가

---

## 참고 자료

### 공식 문서
- [Spring Boot 4.0 Release](https://spring.io/blog/2025/11/20/spring-boot-4-0-0-available-now/)
- [Temporal Java SDK Releases](https://github.com/temporalio/sdk-java/releases)
- [Temporal Deployment Guide](https://docs.temporal.io/self-hosted-guide/deployment)
- [Temporal samples-server (새로운 Docker Compose 예제)](https://github.com/temporalio/samples-server/tree/main/compose)
- [Grafana Alloy Migration](https://grafana.com/docs/loki/latest/setup/migrate/migrate-to-alloy/)
- [Grafana Alloy 문서](https://grafana.com/docs/alloy/latest/)
- [Loki 3.6 Release Notes](https://grafana.com/docs/loki/latest/release-notes/v3-6/)
- [Redisson 4.0.0 Release](https://github.com/redisson/redisson/releases)

### 버전 정보
- **Spring Boot**: 3.4.0 (Core 라이브러리와 동일)
- **Temporal SDK**: 1.32.0 (Spring Boot 3.x 호환)
- **Redisson**: 3.52.0 (Spring Boot 3.4 호환)
- Grafana: 12.3.1 (2026-01 기준)
- Loki: 3.6.0 (2026-01 기준)
- Prometheus: 3.9.1 (2026-01 기준)
